package me.gamrboy4life.paradox.command.commands;

import java.util.Random;
import java.util.Timer;
import java.util.TimerTask;

import me.gamrboy4life.paradox.command.Command;
import net.minecraft.client.Minecraft;
import net.minecraft.network.play.client.C01PacketChatMessage;

public class ChatSpam extends Command {
	
	private Timer spamTimer;
	
	public ChatSpam() {
		super("ChatSpam", "ChatSpamは、「.chatspam 数 任意の文字」でスパムを行える", "chatspam", "c");
		spamTimer = new Timer();
	}
	
	@Override
	public void onCommand(String[] args, String command) {
		if (args.length < 2) {
			return;
		}
		
		int spamCount = Integer.parseInt(args[0]);
		String message = String.join(" ", args).substring(args[0].length() + 1);

		// メッセージの送信を1秒ごとに行うタスク
		spamTimer.schedule(new TimerTask() {
			int count = 0;

			@Override
			public void run() {
				if (count < spamCount) {
					Random random = new Random();
					String uuid = generateRandomUUID(random); // ランダムな4桁のUUIDを生成
					String finalMessage = message + uuid;
					Minecraft.getMinecraft().thePlayer.sendQueue.addToSendQueue(new C01PacketChatMessage(finalMessage));
					count++;
				} else {
					spamTimer.cancel(); // spamCount 回送信したらタイマーを停止
				}
			}
		}, 0, 1000); // 最初の送信はすぐに行い、以降は1秒ごとに送信する
	}
	
	private String generateRandomUUID(Random random) {
		// ランダムな4桁のUUIDを生成するメソッド
		int uuid = random.nextInt(10000); // 0から9999の間でランダムな数を生成
		return String.format("%04d", uuid); // 必ず4桁になるようにフォーマット
	}
}
	
		

