package me.gamrboy4life.paradox.module.combat;

import me.gamrboy4life.paradox.module.Category;
import me.gamrboy4life.paradox.module.Module;
import net.minecraft.client.entity.EntityPlayerSP;
import net.minecraft.entity.Entity;
import net.minecraft.entity.EntityLivingBase;
import net.minecraft.util.math.AxisAlignedBB;
import net.minecraft.util.math.RayTraceResult;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import net.minecraftforge.fml.common.gameevent.InputEvent;
import org.lwjgl.input.Keyboard;

import java.util.List;

public class Reach extends Module {

    public Reach() {
        super("Reach", 0, Category.COMBAT);
    }

    @SubscribeEvent
    public void onKeyInput(InputEvent.KeyInputEvent event) {
        if (Keyboard.isKeyDown(Keyboard.KEY_R)) { // Rキーを押している間、Reachが有効になります
            attackEntitiesWithinReach();
        }
    }

    private void attackEntitiesWithinReach() {
        RayTraceResult rayTraceResult = mc.objectMouseOver;
        if (rayTraceResult != null) {
            double reachDistance = 4.5; // リーチの距離を設定します
            AxisAlignedBB bb = new AxisAlignedBB(
                    mc.thePlayer.posX - reachDistance, mc.thePlayer.posY - reachDistance, mc.thePlayer.posZ - reachDistance,
                    mc.thePlayer.posX + reachDistance, mc.thePlayer.posY + reachDistance, mc.thePlayer.posZ + reachDistance
            );

            List<Entity> entities = mc.theWorld.getEntitiesWithinAABBExcludingEntity(null, bb);
            for (Entity entity : entities) {
                if (entity instanceof EntityLivingBase && entity != mc.thePlayer) {
                    mc.playerController.attackEntity(mc.thePlayer, entity);
                    mc.thePlayer.swingItem();
                }
            }
        }
    }
}