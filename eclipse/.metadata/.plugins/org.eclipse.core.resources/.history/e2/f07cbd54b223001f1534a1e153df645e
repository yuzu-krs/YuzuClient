package me.gamrboy4life.paradox.module.render;

import org.lwjgl.opengl.GL11;

import me.gamrboy4life.paradox.module.Category;
import me.gamrboy4life.paradox.module.Module;
import me.gamrboy4life.paradox.utils.Wrapper;
import net.minecraft.client.renderer.RenderHelper;
import net.minecraft.item.ItemStack;

public class ArmorStatus extends Module{

	public ArmorStatus() {
		super("ArmorStatus",0,Category.RENDER);
	}
	
	@Override
	public void onRender() {
	    if (this.isToggled()) {
	        // 全体のOpenGLの状態を保存
	        GL11.glPushMatrix();
	        
	        // 全体のレンダリング設定
	        RenderHelper.enableGUIStandardItemLighting();
	        GL11.glEnable(GL11.GL_TEXTURE_2D);
	        GL11.glEnable(GL11.GL_DEPTH_TEST);
	        GL11.glDepthMask(true);
	        GL11.glDisable(GL11.GL_BLEND);
	        
	        for (int i = 0; i < mc.thePlayer.inventory.armorInventory.length; i++) {
	            ItemStack itemStack = mc.thePlayer.inventory.armorInventory[i];
	            
	            if (itemStack != null) {
	                // 個々のアイテムの状態を保存
	                GL11.glPushMatrix();
	                int yAdd = (-16 * i) + 48;
	                
	                if (itemStack.getItem().isDamageable()) {
	                    double damage = ((itemStack.getMaxDamage() - itemStack.getItemDamage()) / (double)itemStack.getMaxDamage()) * 100;
	                    Wrapper.fr.drawString(String.format("%.2f%%", damage), 100, 4 + yAdd, -1);
	                }
	                
	                mc.getRenderItem().renderItemAndEffectIntoGUI(itemStack, 100, 4 + yAdd);
	                
	                // 個々のアイテムの状態を復元
	                GL11.glPopMatrix();
	            }
	        }
	        
	        // 全体のレンダリング設定をリセット
	        GL11.glDisable(GL11.GL_DEPTH_TEST);
	        GL11.glDisable(GL11.GL_TEXTURE_2D);
	        GL11.glEnable(GL11.GL_BLEND);
	        RenderHelper.disableStandardItemLighting();
	        
	        // 全体のOpenGLの状態を復元
	        GL11.glPopMatrix();
	    }
	}
}
